<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <section>
      <a href="/">Home</a>
      <a href="/new">Agregar Candidato</a>
    </section>

    <main>
      <section id="candidato"></section>
    </main>
    <script src="./js/global.js" charset="utf-8"></script>
    <script>
      const candidatoSection = document.querySelector('#candidato');

      const candidato_id = parseIDFromURL();

      function showCandidato(candidato) {
        candidatoSection.innerHTML += `
        <div>
            <h2>${candidato.nombres} ${candidato.apellidos}</h2>
            <p>Cedula: ${candidato.cedula}</p>
            <p>Fecha de Nacimiento: ${candidato.dob}</p>
            <p>Trabajo Actual: ${candidato.job_actual}</p>
            <p>Expectativa Salarial: ${candidato.exp_salario}</p>
            <a href="/edit/index.html?id=${candidato._id}">Editar</a>
            <button id="deleteBtn">Eliminar</button>
        </div>
        `;

        const deleteBtn = document.querySelector('#deleteBtn');

        deleteBtn.addEventListener('click', (e) => {
          deleteCandidato(candidato_id).then((result) => {
            console.log(result);
            window.location = '/';
          });
        });
      }

      getCandidato(candidato_id).then(showCandidato);

      async function deleteCandidato(id) {
        const options = {
          method: 'DELETE',
          headers: {
            'content-type': 'application/json',
          },
          body: JSON.stringify(candidato),
        };

        const res = await fetch(`${API_URL}/${id}`, options);

        return res.json();
      }
    </script>
  </body>
</html>
