const data = {
  extrapolationLevel: 1,
  branchNames: [],
  leafNames: ['userId', 'ip', 'duration', 'userActionCount'],
  values: [
    [
      '40237855909',
      '40236213019',
      '22400222513',
      'isidroportes',
      '00112706437',
      'Rmonter14',
      'EMRamirez92',
      'stevensoto',
      'lmsj89',
      'jfelizca1',
      'jimburroughs',
      '40225314810',
      'yahaira14',
      'adriam7',
      null,
      '40210224305',
      'LEONIDAS22',
      'montillagibran',
      '40200692149',
      'randydelacruz21',
      'lverasde',
      'Mayilinceciliatorres',
      null,
      'carlos_salvatore02',
      'richard1312',
      '00104606140',
      'helen197',
      'Josealvarez1973',
      '40229784869',
      'lauracaste16',
      '00107496812',
      null,
      '22301821124',
      '22400620583',
      'agonzal22',
      '03102979170',
      'bayron suarez camilo',
      'bayron suarez camilo',
      'floriselalmonte',
      'bayron suarez camilo',
      '22400620583',
      '22400620583',
      '22400620583',
      '40233023999',
      '22400620583',
      '22400620583',
      '22400620583',
      'bayron suarez camilo',
      'bayron suarez camilo',
      'romangacosta',
      'bayron suarez camilo',
      'bayron suarez camilo',
      'bayron suarez camilo',
      'cdelgadom',
      'Liccarlosacevedo2406',
      null,
      'audit47',
      'Dariel02',
      'pinkphatygirl_1982',
      null,
      null,
      null,
      'milavs',
      null,
      '04801135924',
      'bello_92014',
      'mariaefe',
      'manuca',
      'Nathalieflores',
      'jard1156',
      'mvictor17',
      '02500429861',
      'migueleduardocaba',
      'CONSUJUAN',
      'santanaelvis23',
      null,
      'Julio1990',
      null,
      'nelioadames',
      'darwin_31',
      'junior ortega angele',
      null,
      'ELIZABETHREYESD',
      'aleygue',
      null,
      'katherinesr14',
      '22500300474',
      null,
      'LGsanquintin',
      null,
      'jeremias recio',
      '40210976813',
      'pquiroz',
      '09300653384',
      'Alex199423',
      null,
      null,
      null,
      null,
      null,
      '03600196848',
      null,
      'marbina2015',
      null,
      null,
      'MisticoV',
      'carolineueno',
      null,
      'Carmen Miolan',
      '05100169761',
      'cristduran',
      null,
      '00101097442',
      'javierbido1886',
      null,
      'jserrano3',
      'MAYRA CEPIN',
      '00117586636',
      'Yaquelin28',
      '09900037129',
      'Canongasse',
      'bibi012',
      null,
      '01600211641',
      null,
      'billyrguzmanc',
      '22300281189',
      'ANNA2018',
      null,
      null,
      '00116630112',
      null,
      'Maxprime89',
      null,
      null,
      '22301373126',
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
    ],
    [
      '152.0.132.118',
      '152.0.132.118',
      '152.0.132.118',
      '190.167.192.34',
      '152.0.132.118',
      '186.7.224.195',
      '179.53.112.248',
      '186.6.62.183',
      '148.255.169.67',
      '152.166.147.189',
      '186.7.225.10',
      '186.1.73.3',
      '148.101.39.49',
      '186.7.182.226',
      '186.6.133.137',
      '38.44.240.29',
      '152.166.145.173',
      '190.0.80.202',
      '200.88.235.19',
      '190.113.42.157',
      '152.0.121.248',
      '190.167.169.64',
      '190.167.233.49',
      '181.36.111.119',
      '181.232.190.141',
      '148.101.122.108',
      '152.166.171.206',
      '148.0.74.97',
      '107.127.42.4',
      '148.0.251.7',
      '64.32.75.118',
      '179.52.142.65',
      '152.166.149.132',
      '148.0.91.154',
      '176.159.107.26',
      '190.167.253.47',
      '148.0.91.154',
      '148.0.91.154',
      '68.129.74.162',
      '148.0.91.154',
      '148.0.91.154',
      '148.0.91.154',
      '148.0.91.154',
      '181.37.209.239',
      '148.0.91.154',
      '148.0.91.154',
      '148.0.91.154',
      '148.0.91.154',
      '148.0.91.154',
      '152.0.53.224',
      '148.0.91.154',
      '148.0.91.154',
      '148.0.91.154',
      '152.166.206.62',
      '190.8.35.108',
      '148.101.177.186',
      '179.53.66.79',
      '186.149.131.117',
      '190.80.245.102',
      '148.103.90.247',
      '152.166.161.179',
      '148.103.90.247',
      '104.28.94.65',
      '152.0.242.28',
      '181.215.234.42',
      '148.0.54.91',
      '190.80.177.112',
      '181.232.190.170',
      '99.239.225.58',
      '179.53.142.104',
      '148.0.250.75',
      '148.0.80.230',
      '148.101.128.142',
      '190.166.29.31',
      '181.36.67.106',
      '152.166.157.208',
      '186.6.243.160',
      '190.80.186.131',
      '204.137.175.22',
      '190.167.206.80',
      '152.0.234.16',
      '152.166.196.81',
      '200.88.176.59',
      '79.81.118.111',
      '200.88.239.239',
      '66.98.84.12',
      '190.8.32.240',
      '148.255.219.208',
      '179.53.223.46',
      '190.167.234.137',
      '148.101.201.162',
      '190.103.180.230',
      '190.167.227.179',
      '152.166.160.229',
      '148.101.2.145',
      '190.166.243.223',
      '148.255.44.15',
      '148.101.145.251',
      '200.88.239.191',
      '69.113.35.21',
      '152.0.61.91',
      '45.176.95.77',
      '190.167.234.217',
      '152.0.189.218',
      '190.167.206.171',
      '186.7.56.245',
      '186.120.128.155',
      '186.150.224.177',
      '186.6.127.36',
      '24.104.209.103',
      '83.32.152.44',
      '45.176.95.77',
      '190.80.164.49',
      '148.101.27.181',
      '190.167.233.152',
      '186.149.200.81',
      '190.93.189.4',
      '148.101.161.235',
      '143.208.166.182',
      '152.166.135.106',
      '212.186.0.208',
      '181.37.216.102',
      '45.176.95.77',
      '204.137.174.50',
      '186.7.179.187',
      '200.125.171.89',
      '148.103.131.27',
      '181.37.153.10',
      '190.167.227.208',
      '181.37.25.55',
      '64.32.71.108',
      '179.52.19.190',
      '152.0.10.176',
      '190.166.141.8',
      '186.150.64.110',
      '38.44.50.174',
      '179.53.192.151',
      '139.47.83.180',
      '190.8.32.241',
      '201.229.162.9',
      '68.129.74.162',
      '148.101.145.251',
      '148.101.174.14',
      '148.101.27.181',
      '186.150.18.87',
      '200.39.60.205',
      '148.255.4.200',
      '68.80.182.74',
      '12.195.184.131',
      '181.36.236.226',
      '45.176.95.34',
      '45.176.95.34',
      '66.249.66.22',
      '186.6.255.7',
      '148.101.252.236',
      '186.7.230.215',
      '181.36.240.151',
      '190.94.74.5',
      '181.36.94.202',
      '152.0.222.215',
      '190.80.164.180',
      '186.6.69.73',
      '179.52.23.84',
      '95.124.181.34',
      '181.37.1.107',
      '148.101.38.255',
      '38.51.49.14',
      '181.37.147.250',
      '152.166.158.250',
      '190.167.234.241',
      '190.167.173.139',
      '190.94.74.9',
      '190.167.233.68',
      '190.166.22.113',
      '45.229.34.101',
      '190.167.233.28',
      '45.176.97.51',
      '190.167.68.188',
      '66.249.66.26',
      '186.120.177.173',
      '181.37.213.52',
      '179.53.50.198',
      '201.229.162.202',
      '78.186.126.30',
      '45.176.96.20',
      '66.249.66.22',
      '181.37.213.88',
      '38.44.16.11',
      '168.196.127.229',
      '172.58.203.137',
      '179.52.234.109',
      '181.37.163.59',
    ],
    [
      1471762, 1364933, 1396852, 1376540, 1308449, 3695483, 2537103, 1357752,
      1357699, 1059158, 578408, 1369686, 629781, 1172821, 1257146, 1809758,
      469824, 2954947, 2788635, 661207, 2071120, 326767, 587752, 2233268,
      949107, 2253251, 655360, 2235820, 266662, 571082, 594253, 301962, 1885094,
      251911, 171509, 368105, 259778, 256555, 387578, 260092, 243160, 251433,
      243045, 285582, 249939, 260066, 243028, 260023, 243052, 539329, 249956,
      243186, 243242, 195932, 758643, 1141523, 815154, 413780, 427241, 503384,
      177829, 997101, 280172, 184740, 1103806, 215959, 236454, 360696, 270004,
      479022, 398954, 134667, 47581, 432673, 1833936, 206960, 34431, 137124,
      224881, 79552, 166538, 314445, 1340492, 278768, 688779, 70808, 627617,
      144549, 560064, 253516, 91000, 2640830, 61638, 94460, 329522, 117499,
      86396, 93149, 389152, 89187, 154795, 118271, 58880, 3975717, 130969,
      82157, 33705, 10000, 56637, 110287, 53501, 1867736, 133084, 34252, 252675,
      120546, 39280, 39804, 48916, 811197, 162288, 15622, 43473, 766970, 104025,
      26196, 38863, 38207, 57472, 2215, 19053, 4966, 17860, 87577, 2111, 10217,
      27683, 5345, 500411, 395408, 97023, 10798, 12807, 9814, 5249, 330474, 241,
      1565, 839, 1511, 100, 1205, 97, 1283, 1412, 2962, 1177, 30, 13773, 2419,
      777, 1107, 3535, 1642, 979, 919, 5229, 1235, 4317, 821, 1844, 30, 3879,
      2133, 6759, 2389, 2284, 2427, 97, 3151, 16763, 4472, 2757, 1737, 3630, 97,
      3285, 8072, 30, 3046, 7210, 1792,
    ],
    [
      220, 220, 220, 220, 220, 138, 127, 78, 65, 63, 62, 60, 55, 55, 53, 52, 50,
      47, 40, 38, 37, 37, 36, 36, 34, 34, 29, 29, 25, 25, 23, 22, 21, 19, 19,
      19, 19, 19, 19, 19, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18,
      17, 17, 16, 16, 15, 15, 15, 15, 15, 14, 14, 14, 13, 13, 13, 12, 12, 12,
      11, 11, 11, 11, 10, 10, 10, 10, 10, 10, 10, 10, 9, 9, 9, 9, 9, 9, 9, 9, 9,
      8, 8, 8, 8, 8, 7, 7, 7, 6, 6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,
      5, 5, 4, 4, 4, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 2,
      2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
    ],
  ],
};

async function getJson(param) {
  const values = await getValues(param);

  const data = [];
  for (i = 0; i < values[0].length; i++) {
    let obj = {
      userId: values[0][i],
      ip: values[1][i],
      duration: values[2][i],
      userActionCount: values[3][i],
    };

    data.push(obj);
  }

  return data;
}

async function getHeaders(param) {
  return param['leafNames'];
}

async function getValues(param) {
  return param['values'];
}

async function parseData(param) {
  const replacer = (key, value) => (value === null ? '' : value);
  const headers = await getHeaders(param);
  const json = await getJson(param);

  //console.log(JSON.stringify(json));

  const csv = [
    headers.join(','),
    json.map((row) =>
      headers.map((field) => JSON.stringify(row[field], replacer)).join(',')
    ),
  ];

  for (i = 0; i < csv[1].length; i++) {
    console.log(csv[1][i]);
  }
}

parseData(data);
